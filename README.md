# 温控器草稿说明

`temperature_controller.ino` 是一个基于 ESP32 的温控器示例草稿，核心功能如下：

- **硬件接口**：
  - 通过 I2C 驱动 SSD1306 128×32 OLED 显示屏，用于显示四路温度、工作模式以及电流读数。
  - 使用 MCP342x 16 位 ADC 读取四个热敏电阻通道（默认 I2C 地址 `0x68`）。
  - 通过 ESP32 原生 ADC1 通道 0 读取分流电阻的电压以估算直流电流。
  - 四个按键（SW1–SW4）切换加热、制冷、恒温和待机模式；PNP/NPN 管脚用于驱动加热/制冷桥接。

- **温度计算**：
  - 采用 SEMITEC JT103-050 热敏电阻参数（25℃、10kΩ、B=3435）并按 Beta 模型公式将 ADC 读数换算为摄氏温度。
  - 对异常低的 ADC 读数进行下限保护，避免热敏脱落导致运算异常。

- **控制逻辑**：
  - `mode` 由按键设定：0 待机、1 缓慢升温、2 缓慢降温、3 恒温，长按 `SW3`+`SW4` 进入 4 快速降温。
  - 升/降温模式按设定速率生成目标温度：常规速率 `TPS=0.5℃/分钟`，快速降温 `FAST_TPS=4℃/分钟`，并支持温度过冲时的纠正加热。
  - 恒温模式在 ±0.1℃ 窗口内保持静止，超出则切换加热或制冷。
  - 温度越界保护：T4 高于 42℃ 或低于 10℃ 时自动回到待机。

- **显示与串口输出**：
  - OLED 轮询刷新，显示四路温度、模式与估算电流（单位 A）。
  - 串口 115200 输出原始 ADC、温度、电流与状态，便于调试。

> 该草稿未包含 PID 等复杂控制，仅演示基础的测量、显示与简单逻辑。实际使用需根据硬件校准参数并完善安全保护。
